<div *ngIf="movie; else notFound" class="details-container">
  <div class="movie-info">
    <img [src]="movie.posterUrl" [alt]="movie.title" class="poster" />

    <div class="info">
      <h2>{{ movie.title }}</h2>
      <p><strong>Žanr:</strong> {{ movie.genre }}</p>
      <p><strong>Trajanje:</strong> {{ movie.duration }} min</p>
      <p><strong>Režiser:</strong> {{ movie.director }}</p>
      <p><strong>Glumci:</strong> {{ movie.actors.join(', ') }}</p>
      <p><strong>Datum izlaska:</strong> {{ movie.releaseDate }}</p>
      <p>{{ movie.description }}</p>

      <div *ngIf="avgRating !== null" class="avg">
        Prosečna ocena: <b>{{ avgRating }}</b> ★ ({{ reviews.length }} recenzija)
      </div>
    </div>
  </div>


<div *ngIf="toEmbed(movie?.trailerUrl) as t" class="trailer-wrapper">
  <div class="trailer-box">
    <div class="trailer-aspect">
      <iframe
        [src]="t | safe"
        frameborder="0"
        referrerpolicy="strict-origin-when-cross-origin"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </div>
  </div>
</div>


  <h3>Projekcije</h3>
  <div class="projections">
    <mat-card *ngFor="let p of projections" class="projection-card">
      <mat-card-content>
        <p><strong>Datum:</strong> {{ p.dateTime | date:'short' }}</p>
        <p><strong>Cena:</strong> {{ p.price }} RSD</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button color="primary" (click)="reserve(p)">Rezerviši</button>
      </mat-card-actions>
    </mat-card>
  </div>

  <h3>Recenzije gledalaca</h3>
  <mat-card *ngFor="let r of reviews" class="review-card">
    <mat-card-content>
      <div class="rev-head">
        <b>{{ r.userEmail }}</b>
        <span>{{ r.createdAt | date:'short' }}</span>
      </div>
      <div>Ocena: <b>{{ r.rating }}★</b></div>
      <div *ngIf="r.comment">Komentar: {{ r.comment }}</div>
    </mat-card-content>
  </mat-card>
</div>

<ng-template #notFound>
  <p>Film nije pronađen.</p>
</ng-template>

